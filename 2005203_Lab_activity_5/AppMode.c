/******************************************************************************
* File Name: GPIO.c
* Description: This file contains API definitions for GPIO functionality
* Tool-Chain: AVR GCC
*
* Modification History:
* Created by: Omkar Rane 2005203 V1.0 25/Sep/2020
* Description: V1.0
******************************************************************************/
/******************************************************************************
* Includes
******************************************************************************/
#include"AppMode.h"
#include "GPIO.h"
/******************************************************************************
* Defines and data types
******************************************************************************/
/******************************************************************************
* Global variables
******************************************************************************/
uint16_t ADC_value;
/******************************************************************************
* Static variables
******************************************************************************/
/******************************************************************************
* Internal function prototypes
******************************************************************************/
/******************************************************************************
* Public functions definitions
******************************************************************************/
/******************************************************************************
* Name: GPIOConfig (pin, mode)
* Description: Configures the mode of the pin as INPUT/PULLUP or OUTPUT
* Arguments: pin and mode
* Returns: None
******************************************************************************/
/******************************************************************************
* Internal functions
******************************************************************************/
void AppMode()
{
ADCSRA |= (1 << ADSC);
while (ADCSRA & (1 << ADSC));
ADC_value = ADC;
float voltage = (5.0/1023.0)*((float)ADC_value);


////if(PIN_READ & (1<<PD0))
if(GPIOPinRead(PD0))
{
////Stand-by mode:

//CLR_BIT(PORTD,PD6);
if(FLAG_BIT.FLAG_TIMER==1)
{
FLAG_BIT.FLAG_TIMER = 0;

////GPIOPinWrite(PB7,LOW);
standymode();

}

}

else
{
 ////Sampling mode:
SET_BIT(PORTB,PB7);
///GPIOPinWrite(PB7,HIGH);


if(0.0 <= voltage && voltage < 1.0)
{
OCR0A=64.0;
}
else if(1.0 <= voltage && voltage < 2.0)
{
OCR0A=128.0;
}
else if(2.0 <= voltage && voltage < 3.0)
{
OCR0A=192.0;
}
else if(voltage >= 3.0)
{
OCR0A=255.0;
}


}

}
/******************************************************************************
* Name:
* Description:
******************************************************************************/
/******************************************************************************
/******************************************************************************
* End of File
******************************************************************************/



