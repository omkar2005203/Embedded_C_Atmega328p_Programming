/******************************************************************************
* File Name: GPIO.c
* Description: This file contains API definitions for GPIO functionality
* Tool-Chain: AVR GCC
*
* Modification History:
* Created by:Omkar Rane 2005203 V1.0 25/Sep/2020
* Description: V1.0
******************************************************************************/
/******************************************************************************
* Includes
******************************************************************************/
#include<stdint.h>
#include<stdio.h>
#include<avr/io.h>
#include<avr/interrupt.h>
#include<util/delay.h>
#include"GPIO.h"
#include"AppMode.h"
#include"ModeState.h"

volatile uint16_t counter = 0x00;
uint16_t ADC_value;
/******************************************************************************
* Defines and data types
******************************************************************************/
/******************************************************************************
* Global variables
******************************************************************************/
/******************************************************************************
* Static variables
******************************************************************************/
/******************************************************************************
* Internal function prototypes
******************************************************************************/
/******************************************************************************
* Public functions definitions
******************************************************************************/
/******************************************************************************
* Name:main.c file for lab activity 5
* Description: main.c file for lab activity 5
* Arguments: NA
* Returns: None
******************************************************************************/
/******************************************************************************
* Internal functions
******************************************************************************/
int main(void)
{

//input
GPIOConfig(PD0,INPUT);
GPIOConfig(PD1,INPUT);
GPIOConfig(PD2,INPUT);
GPIOConfig(PD3,INPUT);
//output
GPIOConfig(PD6,OUTPUT);
GPIOConfig(PB7,OUTPUT);
//PULL UP
GPIOPinWrite(PD0,HIGH);
GPIOPinWrite(PD1,HIGH);
GPIOPinWrite(PD2,HIGH);
GPIOPinWrite(PD3,HIGH);

// timer
timer_init();
//ADC
adc_init();
sei(); // Global interrupt
while(1)
{

AppMode();
}
    return 0;
}

/******************************************************************************
* ISR
******************************************************************************/
ISR(TIMER0_OVF_vect) {

  counter++;

if (counter >= 62)
{
    FLAG_BIT.FLAG_TIMER = 1;
    counter = 0;
}
}

//Switch ISR
ISR(INT1_vect)
{
  FLAG_BIT.GPIOMinus_ISR2 = 1;
}

ISR(INT0_vect)
{
 FLAG_BIT.GPIOPlus_ISR1=1;
}

/******************************************************************************
* Name:
* Description:
******************************************************************************/
/******************************************************************************
/******************************************************************************
* End of File
******************************************************************************/

