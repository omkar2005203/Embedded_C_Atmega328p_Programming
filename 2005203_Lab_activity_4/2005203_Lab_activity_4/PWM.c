/******************************************************************************
* File Name: PWM.c
* Description: This file contains API definitions for PWM functionality
* Tool-Chain: AVR GCC
*
* Modification History:
* Created by:Omkar Rane 2005203 V1.0 10/Sep/20
* Description: V1.0
******************************************************************************/
/******************************************************************************
* Includes
******************************************************************************/
#include "PWM.h"
#include "GPIO.h"
/******************************************************************************
* Defines and data types
******************************************************************************/
/******************************************************************************
* Global variables
******************************************************************************/
/******************************************************************************
* Static variables
******************************************************************************/
/******************************************************************************
* Internal function prototypes
******************************************************************************/
/******************************************************************************
* Public functions definitions
******************************************************************************/
/******************************************************************************
* Name: GPIOConfig (pin, mode)
* Description: Configures the mode of the pin as INPUT/PULLUP or OUTPUT
* Arguments: pin and mode
* Returns: None
******************************************************************************/
/******************************************************************************
* Internal functions
******************************************************************************/
void interrupt_config()
{
//pin-change interrupt for mode selection
PCICR |= (1<<PCIE2);
PCMSK2 |= ((1<< PCINT16) | (1<< PCINT17));


//External Interrupt for GPIOPlus and GPIOMinus
EICRA |= ((1 << ISC10)|(1 << ISC00));
EICRA &= ~((1 << ISC11)|(1 << ISC01)); //Any logical change will raise interrupt.
//EICRA |= ((1 << ISC11)|(1 << ISC01)); //Any logical change will raise interrupt.
EIMSK |= ((1 << INT1)|(1 << INT0)); //Local Interrupt enable
}
/******************************************************************************
* Name: GPIOConfig (pin, mode)
* Description: Configures the mode of the pin as INPUT/PULLUP or OUTPUT
* Arguments: pin and mode
* Returns: None
******************************************************************************/
void timer_config()
{
TCCR2A =((1 << WGM01) | (1 << WGM00) |(1 << WGM02)); // fast pwm
TCCR2A |= (1 << COM2A1);
TCCR2A &= ~(1 << COM2A0);// clear on compare match
TCNT2 = 0x00; // Timer counter register
//OCR0A = 128;
TCCR2B |= ((1 << CS22) | (1 << CS21)|(1<<CS20)); // Clock selection 101  //1024 pre-scaler
TIMSK2 |= (1 << TOIE2); //Local Timer Overflow INT enable
}
/******************************************************************************
* Name:
* Description:
******************************************************************************/
/******************************************************************************
/******************************************************************************
* End of File
******************************************************************************/
