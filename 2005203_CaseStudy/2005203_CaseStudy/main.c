/******************************************************************************
* File Name: main.c
* Description: This file main file for Wiper System control
* Tool-Chain: AVR GCC
*
* Modification History:
* Created by: Omkar Rane 2005203 V1.0 25/Sep/2020
* Description: V1.0
******************************************************************************/
/******************************************************************************
* Includes
******************************************************************************/
#include"Wiper.h"
/******************************************************************************
* Defines and data types
******************************************************************************/
/******************************************************************************
* Global variables
******************************************************************************/

volatile uint8_t isr_0=0;
volatile uint8_t isr_1=0;
volatile uint8_t timer_isr=0;
volatile uint16_t counter=0;
/******************************************************************************
* Static variables
******************************************************************************/
/******************************************************************************
* Internal function prototypes
******************************************************************************/
/******************************************************************************
* Public functions definitions
******************************************************************************/
/******************************************************************************
* Name: main.c
* Description: main file
* Arguments: NA
* Returns: None
******************************************************************************/
/******************************************************************************
* Internal functions
******************************************************************************/
int main()
{
    sei();
    PORTC=0x00;
    GPIOConfig(PD2,INPUT);// engine
    GPIOConfig(PD3,INPUT);// wiper
    GPIOConfig(PD6,OUTPUT);

    EIMSK|=(1<<INT1)|(1<<INT0);
    EICRA|=(1<<ISC00);
    EICRA&=~(1<<ISC01);
    EICRA|=(1<<ISC10);
    EICRA&=~(1<<ISC11);

    TCCR0A=0x00;
    TCCR0B=0x00;
    TCCR0B|=(1<<CS02)|(1<<CS00);
    TCCR0B&=~(1<<CS01);
    TIMSK0|=(1<<TOIE0);
    TCNT0=0x64;

    adc_init();
    PWM_init();

    while(1)
    {
        app_mode();
    }
}
/******************************************************************************
* ISR
******************************************************************************/
ISR(INT0_vect)
{
     isr_0=isr_0^1;
}

ISR(INT1_vect)
{
    isr_1=isr_1^1;
}

ISR(TIMER0_OVF_vect)
{
    counter++;
    if(counter==499)
    {
        counter=0;
        timer_isr=1;
    }
}

/******************************************************************************
/******************************************************************************
* End of File
******************************************************************************/



